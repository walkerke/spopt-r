% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/region_spenc.R
\name{spenc}
\alias{spenc}
\title{Spatially-Encouraged Spectral Clustering (SPENC)}
\usage{
spenc(
  data,
  attrs = NULL,
  n_regions,
  weights = "queen",
  bridge_islands = FALSE,
  gamma = 1,
  scale = TRUE,
  seed = NULL,
  verbose = FALSE
)
}
\arguments{
\item{data}{An sf object with polygon or point geometries.}

\item{attrs}{Character vector of column names to use for clustering
(e.g., \code{c("var1", "var2")}). If NULL, uses all numeric columns.}

\item{n_regions}{Integer. Number of regions (clusters) to create.}

\item{weights}{Spatial weights specification. Can be:
\itemize{
\item \code{"queen"} (default): Polygons sharing any boundary point are neighbors
\item \code{"rook"}: Polygons sharing an edge are neighbors
\item An \code{nb} object from spdep or created with \code{\link[=sp_weights]{sp_weights()}}
\item A list for other weight types: \code{list(type = "knn", k = 6)} for
k-nearest neighbors, or \code{list(type = "distance", d = 5000)} for
distance-based weights
}}

\item{bridge_islands}{Logical. If TRUE, automatically connect disconnected
components (e.g., islands) using nearest-neighbor edges. If FALSE (default),
the function will error when the spatial weights graph is disconnected.}

\item{gamma}{Numeric. RBF kernel parameter controlling attribute similarity
decay. Larger values = faster decay = more local similarity. Default is 1.
Can also be "auto" to estimate from data.}

\item{scale}{Logical. If TRUE (default), standardize attributes before clustering.}

\item{seed}{Optional integer for reproducibility.}

\item{verbose}{Logical. Print progress messages.}
}
\value{
An sf object with a \code{.region} column containing cluster assignments.
Metadata is stored in the "spopt" attribute, including:
\itemize{
\item algorithm: "spenc"
\item n_regions: Number of regions created
\item objective: Within-cluster sum of squared distances in embedding space
\item gamma: The gamma parameter used
\item solve_time: Time to solve in seconds
}
}
\description{
Performs spectral clustering with spatial constraints by combining
spatial connectivity with attribute similarity using kernel methods.
This approach is useful for clustering with highly non-convex clusters
or irregular topologies in geographic contexts.
}
\details{
SPENC (Wolf, 2021) extends spectral clustering to incorporate spatial
constraints. The algorithm:
\enumerate{
\item Computes attribute affinity using an RBF (Gaussian) kernel
\item Multiplies element-wise with spatial weights (only neighbors have affinity)
\item Computes the normalized Laplacian of the combined affinity matrix
\item Extracts the k smallest eigenvectors as a spectral embedding
\item Applies k-means clustering to the embedding
}

Key advantages:
\itemize{
\item Can find non-convex cluster shapes
\item Respects spatial connectivity
\item Balances attribute similarity with spatial proximity
}

The gamma parameter controls how quickly attribute similarity decays with
distance in attribute space. Larger values create more localized clusters.
}
\examples{
\dontrun{
library(sf)
nc <- st_read(system.file("shape/nc.shp", package = "sf"))

# Basic SPENC with 8 regions
result <- spenc(nc, attrs = c("SID74", "SID79"), n_regions = 8)

# Adjust gamma for different cluster tightness
result <- spenc(nc, attrs = c("SID74", "SID79"), n_regions = 8, gamma = 0.5)

# View results
plot(result[".region"])
}

}
\references{
Wolf, L. J. (2021). Spatially-encouraged spectral clustering: a technique
for blending map typologies and regionalization. International Journal of
Geographical Information Science, 35(11), 2356-2373.
\doi{10.1080/13658816.2021.1934475}
}

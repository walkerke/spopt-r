% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/region_azp.R
\name{azp}
\alias{azp}
\title{Automatic Zoning Procedure (AZP)}
\usage{
azp(
  data,
  attrs = NULL,
  n_regions,
  weights = "queen",
  bridge_islands = FALSE,
  method = c("tabu", "basic", "sa"),
  max_iterations = 100L,
  tabu_length = 10L,
  cooling_rate = 0.99,
  initial_temperature = 0,
  scale = TRUE,
  seed = NULL,
  verbose = FALSE
)
}
\arguments{
\item{data}{An sf object with polygon or point geometries.}

\item{attrs}{Character vector of column names to use for clustering
(e.g., \code{c("var1", "var2")}). If NULL, uses all numeric columns.}

\item{n_regions}{Integer. Number of regions (clusters) to create.}

\item{weights}{Spatial weights specification. Can be:
\itemize{
\item \code{"queen"} (default): Polygons sharing any boundary point are neighbors
\item \code{"rook"}: Polygons sharing an edge are neighbors
\item An \code{nb} object from spdep or created with \code{\link[=sp_weights]{sp_weights()}}
\item A list for other weight types: \code{list(type = "knn", k = 6)} for
k-nearest neighbors, or \code{list(type = "distance", d = 5000)} for
distance-based weights
}}

\item{bridge_islands}{Logical. If TRUE, automatically connect disconnected
components (e.g., islands) using nearest-neighbor edges. If FALSE (default),
the function will error when the spatial weights graph is disconnected.}

\item{method}{Character. Optimization method: "basic" (greedy local search),
"tabu" (tabu search), or "sa" (simulated annealing). Default is "tabu".}

\item{max_iterations}{Integer. Maximum number of iterations (default 100).}

\item{tabu_length}{Integer. Length of tabu list for tabu method (default 10).}

\item{cooling_rate}{Numeric. Cooling rate for SA method, between 0 and 1
(default 0.99).}

\item{initial_temperature}{Numeric. Initial temperature for SA method.
If 0 (default), automatically set based on initial objective.}

\item{scale}{Logical. If TRUE (default), standardize attributes before clustering.}

\item{seed}{Optional integer for reproducibility.}

\item{verbose}{Logical. Print progress messages.}
}
\value{
An sf object with a \code{.region} column containing cluster assignments.
Metadata is stored in the "spopt" attribute, including:
\itemize{
\item algorithm: "azp"
\item method: The optimization method used
\item n_regions: Number of regions created
\item objective: Total within-region sum of squared deviations
\item solve_time: Time to solve in seconds
}
}
\description{
Performs regionalization using the Automatic Zoning Procedure algorithm.
AZP uses local search to minimize within-region heterogeneity while
maintaining spatial contiguity. Three variants are available: basic
(greedy), tabu search, and simulated annealing.
}
\details{
The Automatic Zoning Procedure (AZP) was introduced by Openshaw (1977) and
refined by Openshaw & Rao (1995). It is a local search algorithm that:
\enumerate{
\item Starts with an initial random partition into n_regions
\item Iteratively moves border areas between regions to reduce heterogeneity
\item Maintains spatial contiguity throughout
\item Terminates when no improving moves are found
}

Three variants are available:
\itemize{
\item \strong{basic}: Greedy local search that only accepts improving moves
\item \strong{tabu}: Tabu search that can accept non-improving moves to escape
local optima, with a tabu list preventing cycling
\item \strong{sa}: Simulated annealing that accepts worse moves with decreasing
probability as temperature cools
}
}
\examples{
\dontrun{
library(sf)
nc <- st_read(system.file("shape/nc.shp", package = "sf"))

# Basic AZP with 8 regions
result <- azp(nc, attrs = c("SID74", "SID79"), n_regions = 8)

# Tabu search (often finds better solutions)
result <- azp(nc, attrs = c("SID74", "SID79"), n_regions = 8,
              method = "tabu", tabu_length = 15)

# Simulated annealing
result <- azp(nc, attrs = c("SID74", "SID79"), n_regions = 8,
              method = "sa", cooling_rate = 0.95)

# View results
plot(result[".region"])
}

}
\references{
Openshaw, S. (1977). A geographical solution to scale and aggregation
problems in region-building, partitioning and spatial modelling.
Transactions of the Institute of British Geographers, 2(4), 459-472.

Openshaw, S., & Rao, L. (1995). Algorithms for reengineering 1991 Census
geography. Environment and Planning A, 27(3), 425-446.
}
